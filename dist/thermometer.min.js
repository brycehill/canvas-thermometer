function Thermometer(t,i){var s;if(!t.getContext)throw new Error("Must pass in a valid <canvas> element!");for(this.opts=i||{},this.ctx=t.getContext("2d"),this.ctx.strokeStyle="#666666",this.width=this.opts.width||100,this.ctx.lineWidth=this.opts.lineWidth||5,this.padding={top:10,bottom:10},this.canvasWidth=this.ctx.canvas.width,this.canvasHeight=this.ctx.canvas.height,this.center=this.canvasWidth/2;2*this.width+2*this.ctx.lineWidth>=this.canvasWidth;)this.width--;this.bigRadius=this.width,this.smallRadius=this.width/2,s=(this.canvasWidth-this.width)/2,this.pos={left:s,right:s+this.width,top:this.smallRadius+this.ctx.lineWidth,bottom:this.canvasHeight-2*this.bigRadius},this.abs={top:this.pos.top-this.smallRadius,bottom:this.canvasHeight-this.padding.bottom}}Thermometer.prototype.empty=function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.drawOutline()},Thermometer.prototype.erase=function(){this.ctx.clearRect(0,0,this.pos.left-5,this.pos.bottom)},Thermometer.prototype.set=function(t,i){return this[t]="Number"!=typeof i?parseInt(i):i,this},Thermometer.prototype.draw=function(){this.empty(),this.drawOutline(),null!=this.data&&this.fill()},Thermometer.prototype.hasMetGoal=function(){return this.data>this.goal},Thermometer.prototype.drawOutline=function(){function t(t){return t*(Math.PI/180)}this.ctx.beginPath(),this.ctx.lineWidth=5,this.ctx.moveTo(this.pos.left,this.pos.bottom),this.ctx.lineTo(this.pos.left,this.pos.top),this.ctx.arc(this.center,this.pos.top,this.smallRadius,t(180),t(0)),this.ctx.lineTo(this.pos.right,this.pos.bottom),this.ctx.arc(this.center,this.canvasHeight-this.bigRadius-this.ctx.lineWidth-this.padding.bottom,this.width,t(300),t(240)),this.ctx.stroke(),this.drawTicks(),null!=this.goal&&this.label("Goal: "+this.goal,this.labelGoal)},Thermometer.prototype.fill=function(){function t(){return(i.abs.bottom-i.abs.top)*(i.data/i.goal)}var i=this,s=t(),h=this.abs.bottom-s,e=this.abs.bottom-h;this.empty(),this.ctx.save(),this.clip(),this.data&&(this.ctx.fillStyle="rgba(255, 70, 20, 0.7)",this.ctx.fillRect(0,h,this.canvasWidth,e),this.oldFillHeight=e,this.oldFillY=h,this.label(this.data,this.labelData),this.drawTicks())},Thermometer.prototype.clip=function(){function t(t){return t*(Math.PI/180)}this.ctx.beginPath(),this.ctx.moveTo(this.pos.left+5,this.pos.bottom),this.ctx.lineTo(this.pos.left+5,this.pos.top),this.ctx.arc(this.center,this.pos.top+5,this.smallRadius-5,t(180),t(0)),this.ctx.lineTo(this.pos.right-5,this.pos.bottom),this.ctx.arc(this.center,this.canvasHeight-this.bigRadius-this.ctx.lineWidth-this.padding.bottom-5+2,this.width-5,t(300),t(240)),this.ctx.clip()},Thermometer.prototype.label=function(t,i){t&&(this.ctx.beginPath(),i.call(this,t),this.ctx.closePath())},Thermometer.prototype.labelGoal=function(t){var i=parseInt(this.ctx.font,10),s=this.ctx.measureText(t),h=s.width+5,e=this.abs.top+i/2;this.ctx.fillStyle="#333",this.ctx.textAlign="left",this.ctx.textBaseline="bottom",this.ctx.font="200 30px Helvetica",this.hasMetGoal()?this.adjustGoalLabel(t):(this.ctx.fillText(t,0,this.abs.top+i,this.pos.left),this.ctx.moveTo(this.pos.left,e),this.ctx.lineTo(h,e),this.ctx.stroke(),this.ctx.arc(h,e,3,0,360*(Math.PI/180)),this.ctx.fill())},Thermometer.prototype.adjustGoalLabel=function(t){function i(){return(s.abs.bottom-s.abs.top)*(s.goal/s.data)}var s=this,h=i(),e=parseInt(this.ctx.font,10),o=this.abs.bottom-h,a=this.ctx.measureText(t);this.ctx.restore(),this.erase(),this.ctx.fillText(t,0,o,this.pos.left),this.ctx.moveTo(this.pos.left,o-e/2),this.ctx.lineTo(a.width+5,o-e/2),this.ctx.stroke(),this.ctx.arc(a.width+5,o-e/2,3,0,360*(Math.PI/180)),this.ctx.fill()},Thermometer.prototype.labelData=function(t){this.ctx.font="200 42px Helvetica",this.ctx.shadowColor="#444",this.ctx.shadowOffsetX=2,this.ctx.shadowOffsetY=2,this.ctx.shadowBlur=7,this.ctx.textBaseline="middle",this.ctx.fillStyle="#fff",this.ctx.textAlign="center",this.ctx.fillText(t,this.center,this.canvasHeight-this.bigRadius-this.ctx.lineWidth-this.padding.bottom-5+2)},Thermometer.prototype.drawTicks=function(){var t,i,s=this.pos.bottom-this.pos.top;this.ctx.fillStyle="#666666",this.ctx.shadowColor="transparent",this.ctx.lineWidth=1;for(var h=0;s>h;h+=10)i=this.pos.bottom-h-this.ctx.lineWidth,t=this.pos.left,this.ctx.moveTo(t,i),t=0!==h&&h%50===0?t+30:t+20,this.ctx.lineTo(t,i),this.ctx.stroke()};